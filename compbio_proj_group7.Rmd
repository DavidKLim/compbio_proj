---
title: "compbio_proj"
author: "David Lim, Mark He, Mike Lafferty"
date: "`r format(Sys.time(), '%m/%d/%Y')`"
output: html_document
---

Figure C:

```{r}
library(readxl)

X <- read_excel("rnaseq_CNS_all.xlsx")
```

```{r}
cor_mat = cor(X[,2:15],method="spearman")
library(pheatmap)
pheatmap(cor_mat)
```




Figure D:

```{r}
sel_genes = c("Gfap","Aldh1l1","Slc1a3","Aqp4","Tubb3",
              "Stmn2","Snap25","Eno2","Syn1","Pdgfra",
              "Cspg4","Enpp6","Nfasc","Pip","Mog","Mbp",
              "Mobp","Ccl3","Itgam","Tnf","Cldn5","Flt1","Esam")

sel_X <- X[X$gene.symbol %in% sel_genes,1:15]  # subsetting genes and omitting WB1,2,3
sel_Xcts <- sel_X[,-1]                       # subset just the counts

sel_means <- rowMeans(sel_Xcts)
library(genefilter)
sel_sd <- rowSds(sel_Xcts)


num_sd <- matrix(0,nrow=nrow(sel_Xcts),ncol=ncol(sel_Xcts))
for(i in 1:nrow(sel_Xcts)){
  num_sd[i,] <- (as.numeric(sel_Xcts[i,]) - sel_means[i])/sel_sd[i]    # calculate # of SD's away from rowMean
}

rownames(num_sd) <- as.matrix(sel_X[,1])
colnames(num_sd) <- colnames(sel_X[,-1])

pheatmap(num_sd[-17,])

##### ISSUES TO RESOLVE: #####
# "Pip" gene has count all = 0.1 --> sd = Inf ??? (row 17)
# Max SDs is 2 in figure. 3 here
# Need to reorder sel_X or num_sd to match the figure
```

Note: "Cd11b" not found. Different name: "Itgam"